<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <atom:link href="https://ashfurrow.com/feed.rss.xml" rel="self" type="application/rss+xml"/>
    <title>Ash Furrow</title>
    <description>Learning and teaching about interesting topics in iOS Development. Sometimes I diverge to talk about design, photography, or what-have-you.</description>
    <link>https://ashfurrow.com/</link>
    <item>
      <title>Breath of the Wild &amp; The Switch</title>
      <link>https://ashfurrow.com/blog/breath-of-the-wild-switch/</link>
      <description>&lt;p&gt;I&amp;rsquo;ve always struggled with video games. I love them but could &lt;a href="/blog/the-joys-and-sorrows-of-being-an-almost-gamer/"&gt;never quite clear the skills curve&lt;/a&gt; of the types of games I enjoyed: role-playing games. So I&amp;rsquo;d get through a good chunk of the game, get really invested in the characters and story, and then get stuck and give up in frustration.&lt;/p&gt;

&lt;p&gt;The &lt;a href="/blog/the-redemption-of-the-almost-gamer/"&gt;last time&lt;/a&gt; I felt good while playing games was to do with &lt;em&gt;Zelda: A Link Between Worlds&lt;/em&gt;. It really got me into a flow state and kept me there and I loved it. I&amp;rsquo;ve replayed &lt;em&gt;Ocarina of Time&lt;/em&gt; on 3DS and beat it, and it felt amazing. So I&amp;rsquo;ve changed, and Zelda&amp;rsquo;s changed, and I&amp;rsquo;m cautiously optimistic about how I might get on with contemporary Zelda games.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;So. &lt;/p&gt;

&lt;p&gt;In what&amp;rsquo;s basically a &lt;a href="https://www.youtube.com/watch?v=f5uik5fgIaI"&gt;flawless product video&lt;/a&gt;, the Switch was announced six months ago. And I knew I would get one eventually. Because just look at that thing.&lt;/p&gt;



&lt;div class='embed-responsive embed-responsive-16by9'&gt;&lt;iframe src='//www.youtube.com/embed/f5uik5fgIaI' frameborder='0' allowfullscreen&gt;&lt;/iframe&gt;&lt;/div&gt;



&lt;p&gt;I don&amp;rsquo;t buy game consoles – and I certainly don&amp;rsquo;t buy them early – because I Am Not A Gamer. But this time, it&amp;rsquo;s different. Both &lt;em&gt;Breath of the Wild&lt;/em&gt;, the new Zelda game, and the Switch had me so excited that I got one only a few months after it launched. And I&amp;rsquo;m blown away by both.&lt;/p&gt;

&lt;p&gt;The Switch is amazing, hardware wise. It&amp;rsquo;s basically a super-beefy tablet that plays Nintendo games and has a decent host OS. The little controllers (&amp;ldquo;joy cons&amp;rdquo;) are great. I&amp;rsquo;ve been playing mostly with the Switch connected to a TV, and I use the joy cons independently of one another, which is cool. I think I&amp;rsquo;m going to get the one-piece pro controller and see how it feels, since I&amp;rsquo;m playing a lot (and so is Ashley). &lt;/p&gt;

&lt;p&gt;What I&amp;rsquo;m really excited for is &lt;em&gt;Breath of the Wild&lt;/em&gt;. Everyone I know who has played it has been blown away, and based on the overwhelming positive response, I&amp;rsquo;ve been super-pumped. &lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/breath-of-the-wild-switch/botw.jpg" alt="More like Breath the Fresh Air amirite" /&gt;&lt;/p&gt;



&lt;p&gt;I&amp;rsquo;ll spare you my review by saying I agree with &lt;a href="http://kotaku.com/the-legend-of-zelda-breath-of-the-wild-the-kotaku-rev-1792885174"&gt;the spirit of this one&lt;/a&gt;. I love that there are different ways to solve every puzzle, but more than that: I love that it&amp;rsquo;s possible to beat the game without solving &lt;em&gt;every&lt;/em&gt; puzzle. If I get stuck, it&amp;rsquo;s okay because I can come back later, or never.&lt;/p&gt;

&lt;p&gt;In a similar vein to &lt;em&gt;Portal&lt;/em&gt;, &lt;em&gt;Breath of the Wild&lt;/em&gt; kind of normalizes the fact that you&amp;rsquo;ll die. And I have. A lot. But that&amp;rsquo;s okay because the game&amp;rsquo;s autosave does a great job of making sure I never loose much progress. Amazing. &lt;/p&gt;

&lt;p&gt;I was &lt;a href="https://twitter.com/ashfurrow/status/859467299320999937"&gt;initially frustrated&lt;/a&gt; at the beginning of the game because it&amp;rsquo;s quite difficult until you have levelled up a bit. But after that hump (which I cleared this time, awww yeah) it&amp;rsquo;s super-fun.&lt;/p&gt;

&lt;p&gt;So yeah. Games. Maybe I&amp;rsquo;ll always be casual gamer but I&amp;rsquo;m really into what Nintendo&amp;rsquo;s doing right now. The Switch is an actual console, so maybe it&amp;rsquo;ll be a gateway into other, more serious games that get ported to it. I&amp;rsquo;m excited!&lt;/p&gt;
</description>
      <pubDate>Thu, 04 May 2017 17:14:48 +0000</pubDate>
      <guid>https://ashfurrow.com/blog/breath-of-the-wild-switch/</guid>
    </item>
    <item>
      <title>Contributing to Mastodon</title>
      <link>https://ashfurrow.com/blog/contributing-to-mastodon/</link>
      <description>&lt;p&gt;So Mastodon. Obviously, I&amp;rsquo;m into it. &lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve been running an instance for weeks now and it&amp;rsquo;s been great! Some tensions, some conflicts, but overall very rewarding and worth any costs. &lt;/p&gt;

&lt;p&gt;&lt;a href="https://www.patreon.com/ashfurrow"&gt;My Patreon&lt;/a&gt; to pay for server costs is fully funded, the &lt;a href="/blog/moving-mastodon-to-digital-ocean/"&gt;switch to Digital Ocean&lt;/a&gt; has gone smoothly, and so I&amp;rsquo;ve begun looking for more ways to contribute.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;blockquote class="twitter-tweet" data-lang="en"&gt;&lt;p lang="en" dir="ltr"&gt;It’s my birthday, but I got you a present: &lt;a href="https://t.co/Hixblpmg5A"&gt;https://t.co/Hixblpmg5A&lt;/a&gt;&lt;/p&gt;&amp;mdash; Federated Furrow (@ashfurrow) &lt;a href="https://twitter.com/ashfurrow/status/853645778463723520"&gt;April 16, 2017&lt;/a&gt;&lt;/blockquote&gt; &lt;script async src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;See, the web is &lt;a href="/blog/the-web-and-mastodon/"&gt;something we create&lt;/a&gt;, and I want to help create Mastodon. Yeah I do that by hosting an instance, but I&amp;rsquo;m a software developer and I love to build things. So I&amp;rsquo;ve been picking off easy issues &lt;a href="https://github.com/tootsuite/mastodon"&gt;on the repo&lt;/a&gt;, gradually moving towards harder ones. I took a look at all &lt;a href="https://github.com/tootsuite/mastodon/pulls?utf8=✓&amp;amp;q=%20author%3Aashfurrow%20"&gt;the issues/pull requests I&amp;rsquo;ve opened&lt;/a&gt;, and wow. I&amp;rsquo;m getting to know the project better and better over time, including things outside the codebase. The creator granted me rights to manage GitHub issues, so I&amp;rsquo;ve been deduplicating bug reports, reviewing pull requests, and labelling issues. It&amp;rsquo;s been great!&lt;/p&gt;

&lt;p&gt;While the developer community has been welcoming, the Mastodon project (and leadership) have been straining under the stress of Mastodon&amp;rsquo;s meteoric rise in popularity. What&amp;rsquo;s nice is that they&amp;rsquo;re being very conscientious and thoughtful about how to address &lt;a href="https://medium.com/@alliethehart/gameingers-are-dead-and-so-is-mastodon-705b535ed616"&gt;concerns from the community&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;While I have lots of experience in open source community management, I&amp;rsquo;ve never led a project operating at this scale, so I&amp;rsquo;m mostly listening and only offering advice where appropriate.  I think this is especially important, as I live many dimensions of privilege, and the project started and continues to be run by many people of marginalized groups. Even the ability to donate my time to Mastodon is a form of privilege, so I&amp;rsquo;m trying to be conscientious of that.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m looking forward to continuing to learn about Rails, React, and the Mastodon community. It&amp;rsquo;s been a blast so far, despite being challenging, and I don&amp;rsquo;t intend to stop any time soon.&lt;/p&gt;
</description>
      <pubDate>Tue, 25 Apr 2017 16:49:27 +0000</pubDate>
      <guid>https://ashfurrow.com/blog/contributing-to-mastodon/</guid>
    </item>
    <item>
      <title>The Web and Mastodon</title>
      <link>https://ashfurrow.com/blog/the-web-and-mastodon/</link>
      <description>&lt;p&gt;I read a &lt;a href="https://medium.com/glitch/the-web-was-supposed-to-be-a-thing-we-make-c023b6e7f56a"&gt;blog post from Glitch&lt;/a&gt; about their graphic design, and something in it really struck me.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;It’s easy to forget in an era of billion-dollar Internet startups that the original vision of the web was that it’s something we make, not just something we consume.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The web: something we make, not just something we consume.&lt;/p&gt;

&lt;p&gt;This hit me because I&amp;rsquo;ve been &lt;a href="https://ashfurrow.com/blog/mastodon/"&gt;running a Mastodon instance&lt;/a&gt; for two weeks. Let me explain. Beyond administering a tech-focused instance, I&amp;rsquo;ve also been contributing to their community with added documentation, new ideas, and code. It&amp;rsquo;s been an incredibly rewarding experience, in large part because of the community. Being a part of Mastodon feels like being a part of something much bigger than just myself.&lt;/p&gt;

&lt;p&gt;Mastodon is the Web at its best. I&amp;rsquo;m building a space, the community is building social norms, it&amp;rsquo;s so participatory and so refreshing and so rewarding. &lt;/p&gt;

&lt;p&gt;But the thing is, I&amp;rsquo;m a bit tired of pundits wringing their hands about Mastodon: &amp;ldquo;will it be a success?&amp;rdquo;, &amp;ldquo;how can it beat Twitter?&amp;rdquo;, blah blah blah. Who cares? &lt;/p&gt;

&lt;p&gt;One article &lt;a href="http://www.zdnet.com/article/is-mastodon-the-new-social-media-star-or-imploding-black-hole/"&gt;cuts to the heart&lt;/a&gt; of pundits&amp;rsquo; problematic hot takes:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;And therein lies the issues for brands who want to join this new network and advertise to the community.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Ugh, who cares about brands. We – me and the other Mastodonians – are making something &lt;em&gt;for us&lt;/em&gt; and not for brands. Sorry if that offends.&lt;/p&gt;

&lt;p&gt;Mastodon isn&amp;rsquo;t defined by its relation to Twitter or to Facebook or to Snapchat. It&amp;rsquo;s not trying to be anything other than what it is. The developers are doing this because they like it. The admins are doing this because they like it. The users are doing this because they like it.&lt;/p&gt;

&lt;p&gt;Leave us out of your hot takes, &lt;em&gt;please&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m not saying things are perfect – there are tensions and conflicts in any community – but the fediverse feels so much happier and friendly than Twitter has for years. Maybe ever. It&amp;rsquo;s the salad days of Mastodon, just enjoy it! Aww yeah!&lt;/p&gt;
</description>
      <pubDate>Mon, 17 Apr 2017 23:15:17 +0000</pubDate>
      <guid>https://ashfurrow.com/blog/the-web-and-mastodon/</guid>
    </item>
    <item>
      <title>Moving Mastodon to Digital Ocean</title>
      <link>https://ashfurrow.com/blog/moving-mastodon-to-digital-ocean/</link>
      <description>&lt;p&gt;This morning &lt;a href="/blog/mastodon-hosting-migration-plan/"&gt;I wrote about&lt;/a&gt; my plans to move from hosting &lt;a href="https://mastodon.technology"&gt;my mastodon instance&lt;/a&gt; on Heroku to hosting it on AWS. Well I got some feedback, and I did some thinking, and I changed my plan, and then I actually did the whole thing! I&amp;rsquo;m now hosting on &lt;a href="https://m.do.co/c/4a83a8a7aedf"&gt;Digital Ocean&lt;/a&gt; (referral link) and I kind of love it.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;My primary reason for moving hosts was cost. I really like Heroku, but you pay a premium for the convenience of it. That&amp;rsquo;s why I planned to switch to AWS, but &lt;em&gt;turns out&lt;/em&gt; you can end up paying a lot for convenience on AWS, too. I found there were comparable costs for Redis and Postgres services between Heroku and AWS, the those were the two things I was expecting to save the most on.&lt;/p&gt;

&lt;p&gt;I know that you save money when you roll up your sleeves and start administer your own database, but I didn&amp;rsquo;t realize how much. Luckily, the Mastodon developers know administrating stuff is hard, so they have support for &lt;a href="https://www.docker.com"&gt;Docker&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Docker is &lt;em&gt;like&lt;/em&gt; a virtual machine (don&amp;rsquo;t @ me) and the Mastodon developers include what are basically recipes for Docker containers to be built from, and to run from. Combined with &lt;a href="http://digitalmind.io/post/deploying-mastodon-on-digital-ocean"&gt;this blog post&lt;/a&gt;, I was able to get a test instance of Mastodon up within a half hour. &lt;/p&gt;

&lt;p&gt;Which, wow, that amazed me. I&amp;rsquo;ve historically had a lot of trouble deploying stuff, and this was amazing. I couldn&amp;rsquo;t believe how quickly I had something working. But enough gushing over Docker.&lt;/p&gt;

&lt;p&gt;I originally had a complicated migration strategy. Originally. Then, instead of doing a bunch of complicated configuration to get zero-or-near-zero downtime, I just took the instance down. The whole process took twenty minutes, and would have been shorter but I ran into problems importing the Postgres database backup. &lt;/p&gt;

&lt;p&gt;Things went well! I&amp;rsquo;ve got SSL set up like before, and also gained IPv6 support. Somehow, I guess, I lost the Redis database? I&amp;rsquo;m not sure, but things are working well enough that I&amp;rsquo;m not going to worry about it.&lt;/p&gt;

&lt;p&gt;So how are things working? Well, I don&amp;rsquo;t have a response time graph anymore but interactions feel a little slower. CPU utilization is peaking at 30%, and RAM is near 30% as well.&lt;/p&gt;

&lt;p&gt;So what about the costs? Well, I&amp;rsquo;m currently running on a $40/month virtual machine, plus some backup, S3, and Mailgun costs, so I&amp;rsquo;m pegging it at $50–60, or about a third of what I was paying on Heroku. The VM has 4GB of RAM, 2 virtual CPUs, 30GB of SSD space, and 4TB of network transfer a month. Not bad! &lt;/p&gt;

&lt;p&gt;The constellation of Heroku Dynos and Add-Ons has been reduced to one virtual computer running contains each for Sidekiq, Rails-on-Puma, Redis, and Postgres. Everything is stored to the main disk but I may take a look at Digital Ocean&amp;rsquo;s dedicated storage volumes soon.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m going to leave it running as-is and look at tuning or reducing costs until I have a solid baseline of how things are working. I kind of miss my Papertrail logs and my response time graphs, so I&amp;rsquo;ll probably customize the code a bit. &lt;/p&gt;
</description>
      <pubDate>Fri, 14 Apr 2017 00:14:01 +0000</pubDate>
      <guid>https://ashfurrow.com/blog/moving-mastodon-to-digital-ocean/</guid>
    </item>
    <item>
      <title>Mastodon Hosting Migration Plan</title>
      <link>https://ashfurrow.com/blog/mastodon-hosting-migration-plan/</link>
      <description>&lt;p&gt;I&amp;rsquo;ve been &lt;a href="/blog/running-mastodon-on-heroku/"&gt;running Mastodon on Heroku&lt;/a&gt; for about a week now, and it&amp;rsquo;s been a blast! Heroku is really convenient, but it&amp;rsquo;s also expensive. So I&amp;rsquo;m looking at an alternative hosting plan. Because I&amp;rsquo;m learning as I go along, I wanted to write a post about my migration plan, to hopefully get feedback from people who&amp;rsquo;ve done this kind of thing before. &lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s start with the current infrastructure: two Heroku apps, one for streaming and one for everything else. Estimated costs are ~$150/month. I don&amp;rsquo;t know what to expect from AWS, but from my experience I&amp;rsquo;m guess that it&amp;rsquo;ll be a lot less than I&amp;rsquo;m paying now. Additionally, as the community scales up, I&amp;rsquo;ll be able to more easily scale my instance.&lt;/p&gt;

&lt;p&gt;I considered Digital Ocean, since it would probably be even cheaper, but I would have to do a lot more to administer Postgres and Redis instances, which seems boring and tedious. I&amp;rsquo;d rather use RDS and ElastiCache respectively for the convenience.&lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/mastodon-hosting-migration-plan/heroku.png" alt="Current Heroku Infrastructure" /&gt;&lt;/p&gt;



&lt;p&gt;What I&amp;rsquo;m thinking of is an AWS infrastructure that replaces Heroku Add-Ons for AWS services. I figure if I&amp;rsquo;m getting into AWS hosting I may as well dive right in, to get the most advantage from fully participating in their ecosystem.&lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/mastodon-hosting-migration-plan/aws.png" alt="Proposed AWS Infrastructure" /&gt;&lt;/p&gt;



&lt;p&gt;(Note that both infrastructures use S3 for static asset hosting, which is not shown.)&lt;/p&gt;

&lt;p&gt;So the big question is, how do I go from one to the other? Well here&amp;rsquo;s my plan:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Migrate Postgres from a Heroku Add-On to AWS&amp;rsquo; RDS service&lt;/strong&gt;. This is the highest priority since Heroku&amp;rsquo;s Postgres Add-On is currently the highest cost. I expect some downtime as I put the existing app in maintenance mode, export the database, and import it into RDS. I&amp;rsquo;ll do a dry-run first to make sure things work; maybe I&amp;rsquo;ll set up a fresh Heroku app that points to the new database. The nice thing is, if things go wrong I can just point back to the existing database. Once I verify things are working (maybe give it a few days?) I&amp;rsquo;ll retire the existing database Add-On.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Migrate Redis from a Heroku &lt;a href="https://redislabs.com/products/redis-cloud/"&gt;Redis Cloud&lt;/a&gt; Add-On to AWS&amp;rsquo; ElastiCache service&lt;/strong&gt;. This is a lower priority because I expect it&amp;rsquo;ll take some figuring out, and there&amp;rsquo;ll be some downtime. My plan is to set up ElastiCache to replicate the existing store, put the app into maintenance mode, give the new store a chance to catch up, and switch the app over to the new store. Let me know if you&amp;rsquo;ve done this before and see any problems with this.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Migrate from Heroku Dynos to AWS EC2&lt;/strong&gt;. This is the biggest question mark for me. It&amp;rsquo;s going to require a lot of effort because I&amp;rsquo;ve not run a server like this before. Basically I&amp;rsquo;ll get an EC2 running the web server, streaming server, and Sidekiq jobs, make sure it&amp;rsquo;s working, and then switch the DNS to slowly move everyone over to the new server. Once DNS changes have fully propagated, retire the Dynos. If I have to, I&amp;rsquo;ll separate out the web, streaming, and Sidekiq responsibilities into separate instances. Let me know if this is something I should do from the start.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Deal with the little things&lt;/strong&gt;. Stuff like setting up cron jobs, making sure logging is working, that kind of stuff.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Aaaaaaand I think that&amp;rsquo;s it. Hopefully minimal downtime.&lt;/p&gt;

&lt;p&gt;This is a learning experience for me. It seemed really scary at first but writing it out made things make more sense.&lt;/p&gt;

&lt;p&gt;I reckon this will take a solid weekend of work, but I&amp;rsquo;m happy to do it because a) I really like Mastodon and contributing to a distributed community is rewarding, and b) I&amp;rsquo;ll learn a tonne, which is its own reward.&lt;/p&gt;

&lt;p&gt;And again, any advice you have would be welcome. &lt;a href="http://mastodon.technology/@ashfurrow"&gt;Toot me&lt;/a&gt; or &lt;a href="mailto:ash@ashfurrow.com"&gt;send me an email&lt;/a&gt; if you have any advice, and I&amp;rsquo;ll amend my post.&lt;/p&gt;
</description>
      <pubDate>Thu, 13 Apr 2017 13:57:45 +0000</pubDate>
      <guid>https://ashfurrow.com/blog/mastodon-hosting-migration-plan/</guid>
    </item>
    <item>
      <title>Running Mastodon on Heroku</title>
      <link>https://ashfurrow.com/blog/running-mastodon-on-heroku/</link>
      <description>&lt;p&gt;So I&amp;rsquo;ve been &lt;a href="/blog/mastodon-administration/"&gt;running an instance&lt;/a&gt; of &lt;a href="https://github.com/tootsuite/mastodon"&gt;Mastodon&lt;/a&gt; this week. It&amp;rsquo;s be a fun adventure! I&amp;rsquo;m still not sure where it&amp;rsquo;ll end up but I&amp;rsquo;m learning a tonne. So let&amp;rsquo;s share some of what I&amp;rsquo;ve learned by running Mastodon on &lt;a href="http://heroku.com"&gt;Heroku&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If you&amp;rsquo;d like to help out with some of the hosting costs, please head on over &lt;a href="https://patreon.com/user?u=3581610"&gt;to my Patreon&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/running-mastodon-on-heroku/info.png" alt="Extended info" /&gt;&lt;/p&gt;



&lt;p&gt;First, a few things. I &lt;em&gt;love&lt;/em&gt; Heroku; it&amp;rsquo;s server administration that&amp;rsquo;s friendly to iOS developers like me who don&amp;rsquo;t know anything about server administration. But! Heroku support for Mastodon is  e x p e r i m e n t a l . That&amp;rsquo;s fine, this whole thing is an experiment! Life is an experiment. And like life, there are some issues I&amp;rsquo;ve run into.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/tootsuite/mastodon/issues/1007"&gt;&lt;strong&gt;&lt;del&gt;Animated GIF upload doesn&amp;rsquo;t work&lt;/del&gt;&lt;/strong&gt;&lt;/a&gt;. GIFs are transcoded on the Mastodon server, and that requires ffmpeg to be in your buildpack. But that will put you &lt;em&gt;just&lt;/em&gt; over the 300MB slug size on Heroku.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/tootsuite/mastodon/issues/1119"&gt;&lt;strong&gt;&lt;del&gt;Streaming API doesn&amp;rsquo;t work&lt;/del&gt;&lt;/strong&gt;&lt;/a&gt;. Not sure of the cause yet.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;strong&gt;Edit&lt;/strong&gt;: These are being addressed in more long-term ways, but for now I&amp;rsquo;ve gotten them to work. Check out the issues for more details.)&lt;/p&gt;

&lt;p&gt;Now to the good stuff: how to get Mastodon set up. &lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/running-mastodon-on-heroku/resources.png" alt="Heroku Resources" /&gt;&lt;/p&gt;



&lt;p&gt;The initial deploy (use the &amp;ldquo;Deploy to Heroku&amp;rdquo; button &lt;a href="https://github.com/tootsuite/mastodon#deployment-on-heroku-experimental"&gt;in the readme&lt;/a&gt; is going to install two dynos, Redis, and Postgres. You &lt;a href="https://github.com/tootsuite/mastodon/blob/4e41cd9ab8f51120d558b70528b163c98993be53/config/puma.rb#L11-L13"&gt;only need the first Dyno&lt;/a&gt;, the web one.&lt;/p&gt;

&lt;p&gt;I registered a domain (&lt;a href="https://mastodon.technology"&gt;mastodon.technology&lt;/a&gt;) with &lt;a href="https://www.hover.com"&gt;Hover&lt;/a&gt; and used Heroku&amp;rsquo;s SSL support to serve the Mastodon instance over HTTPS. It&amp;rsquo;s 2017, after all.&lt;/p&gt;

&lt;p&gt;On Heroku, your limiting resource is going to be RAM. I&amp;rsquo;m using one 2x Dyno for the extra RAM, and I&amp;rsquo;ve set the &lt;code&gt;WEB_CONCURRENCY&lt;/code&gt; environmental variable to &lt;code&gt;1&lt;/code&gt; to avoid scaling issues.&lt;/p&gt;

&lt;p&gt;&lt;a href="https://elements.heroku.com/addons/papertrail"&gt;Papertrail&lt;/a&gt; is logging service. I tried their free tier but exceeded my daily log limit the second day.&lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/running-mastodon-on-heroku/postgres.png" alt="Postgres" /&gt;&lt;/p&gt;



&lt;p&gt;I had to &lt;a href="https://devcenter.heroku.com/articles/upgrading-heroku-postgres-databases"&gt;upgrade my Postgres instance&lt;/a&gt; almost immediately. It&amp;rsquo;s not difficult to do, which was nice. Heroku makes a lot of this &lt;em&gt;super&lt;/em&gt; easy.&lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/running-mastodon-on-heroku/redis.png" alt="Redis" /&gt;&lt;/p&gt;



&lt;p&gt;I also needed to upgrade my Redis instance almost immediately, to avoid &lt;a href="https://github.com/tootsuite/mastodon/issues/957"&gt;500 errors&lt;/a&gt;. Redis was the first scaling problem I hit. It looks like a super-useful service, but is priced really aggressively on Heroku. I understand why – Heroku is a business trying to make money – but it&amp;rsquo;s frustrating that costs double for a few extra megabytes of RAM. Or maybe I just don&amp;rsquo;t understand how Redis works &lt;code&gt;¯\_(ツ)_/¯&lt;/code&gt;.&lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/running-mastodon-on-heroku/scheduler.png" alt="Scheduler for cron jobs" /&gt;&lt;/p&gt;



&lt;p&gt;I added a &lt;a href="https://elements.heroku.com/addons/scheduler"&gt;scheduler&lt;/a&gt; add-on for some of the &lt;a href="https://github.com/tootsuite/mastodon#tasks"&gt;cron tasks&lt;/a&gt;. I&amp;rsquo;m still experimenting with the task frequency, but you can see what works for you.&lt;/p&gt;

&lt;p&gt;Okay, so that&amp;rsquo;s the Heroku setup. I also used &lt;a href="https://www.mailgun.com"&gt;Mailgun&lt;/a&gt; for email sending (the free tier is fine) and &lt;a href="https://aws.amazon.com"&gt;AWS S3&lt;/a&gt; for storing media that gets uploaded (dunno costs there yet). Additionally, I&amp;rsquo;m using free &lt;a href="https://www.cloudflare.com"&gt;Cloudflare&lt;/a&gt; as a CDN in front of S3, and to host the S3 bucket on its own domain (static.mastodon.technology) that has a Cloudflare SSL certificate. This is important. Without HTTPS support for your media uploads, you&amp;rsquo;ll be serving mixed content (HTTP assets on an HTTPS page). This causes problems on iOS and some web browsers.&lt;/p&gt;

&lt;p&gt;The worst part was just waiting for the DNS changes to propagate. I&amp;rsquo;m using Cloudflare for DNS, and pointed the domain name servers from Hover to use Cloudflare.&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;Even after all this configuration, I&amp;rsquo;m still running into performance issues. The site completely fell over this morning and I have no idea why.&lt;/p&gt;



&lt;p&gt;&lt;img src="https://ashfurrow.com/img/blog/running-mastodon-on-heroku/perf.png" alt="Performance" /&gt;&lt;/p&gt;



&lt;p&gt;It leads me to wonder how long I can keep this up, but like I said, life is an experiment and I&amp;rsquo;m just rolling with it.&lt;/p&gt;

&lt;p&gt;Heroku support is experimental, and like Mastodon, it&amp;rsquo;s continuing to evolve. If you have small needs, I&amp;rsquo;d say go for it. If you want to be the next big instance, you&amp;rsquo;ll need to invest in a more sophisticated hosting solution. I looked at Digital Ocean for using the Docker image but quickly got in over my head; Heroku is it for me.&lt;/p&gt;
</description>
      <pubDate>Fri, 07 Apr 2017 15:50:03 +0000</pubDate>
      <guid>https://ashfurrow.com/blog/running-mastodon-on-heroku/</guid>
    </item>
  </channel>
</rss>
